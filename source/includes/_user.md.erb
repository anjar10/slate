# User
This section list all endpoints related user object.

## Login

### Request
`POST <%= config[:base_url] %>/user/login`

```http
POST /user/login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $api_key = '[API_KEY]';
  $payloads = [
    'token' => '[GENERATED_TOKEN_BY_CLIENT]',
    'state' => '[STATE]'
  ];

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/login");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);
  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($payloads));

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/login" \
  -X POST \
  -H "api-key: [API_KEY]" \
  -d token="[GENERATED_TOKEN_BY_CLIENT]" \
  -d state="[STATE]"
```

**Parameters**

Parameter | Type | Description
--------- | ----------- | -----------
`token` | *string* | **`required`**<br>Token generated by third party application. Token should be unique per user.
`state` | *string* | **`required`**<br>Encrypted String, please ask <a href='mailto:anjar@flip.id'>us</a> to get the formula.

### Response
> The above request returns JSON structured like this:

```json
{
  "token" : "[TOKEN_GENERATED_BY_FLIP]"
}
```

Attribute | Description
----------|-------------
`token` | Unique user token

## Logout

### Request
`POST <%= config[:base_url] %>/user/logout`

```http
POST /user/logout HTTP/1.1
Content-Type: application/x-www-form-urlencoded
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $api_key = '[API_KEY]';

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/logout");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/logout" \
  -X POST \
  -H "api-key: [API_KEY]" \
  -d token="[GENERATED_TOKEN_BY_CLIENT]" \
  -d state="[STATE]"
```

### Response
> The above request returns JSON structured like this:

```json
{
  "message": "User was logged out succesfully"
}
```

## Sign Up

### Request
`POST <%= config[:base_url] %>/user/signup`

```http
POST /user/signup HTTP/1.1
Content-Type: application/x-www-form-urlencoded
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $api_key = '[API_KEY]';
  $user_token= '[USER_TOKEN]';
  $payloads = [
    'email' => 'dummy@email.com',
    'name' => 'Im Dummy',
    'password' => 'dummypassword',
    'phone_number' => '+6281318171234',
    'city' => 311,
    'identity_number' => '317500010001',
    'identity_type' => 'ktp',
    'birth_date' => '2000-01-01',
    'birth_place' => 3492,
    'address' => 'Jln. Dummy Place',
    'token' => '[GENERATED_TOKEN_BY_CLIENT]',
    'state' => '[STATE]'
  ];

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/login");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);
  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($payloads));

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/login" \
  -X POST \
  -H "api-key: [API_KEY]" \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -d "email"="dummy@email.com" \
  -d "name"="Im Dummy" \
  -d "password"="dummypassword" \
  -d "phone_number"="+6281318171234" \
  -d "city"="311" \
  -d "identity_number"="317500010001" \
  -d "identity_type"="ktp" \
  -d "birth_date"="2000-01-01" \
  -d "birth_place"="3492" \
  -d "address"="Jln. Dummy Place"
```

**Parameters**

Parameter | Type | Description
--------- | ----------- | -----------
`token` | *string* | **`required`**<br>Token generated by third party application. Token should be unique per user.
`state` | *string* | **`required`**<br>Encrypted String, please ask <a href='mailto:anjar@flip.id'>us</a> to get the formula.
`email` | *string* | **`optional`**<br>User's email
`name` | *string* | **`optional`**<br>User's full name
`identity_type` | *string* | **`optional`**<br>User's identity type. Pick one from the option. Options:<ul><li>`ktp`<br>Identity card (acronym of Kartu Tanda Penduduk)</li><li>`sim`<br>Driving license (acronym of Surat Izin Mengemudi)</li><li>`paspor`<br>Passport</li></ul>
`identity_number` | *string* | **`optional`**<br>User's identity number depends on `identity_type`
`birth_date` | *string* | **`optional`**<br>User's birth date.<br>`Format: YYYY-MM-DD`
`birth_place` | *string* | **`optional`**<br>User's birth place.<br>Base on city code list
`address` | *string* | **`optional`**<br>Current user's address.
`city` | *string* | **`optional`**<br>Current user's city of residence<br>Base on city code list
`phone_number` | *string* | **`optional`**<br>User's phone number. Start with country code.

### Response
> The above request returns JSON structured like this:

```json
{
  "token" : "[TOKEN_GENERATED_BY_FLIP]"
}
```

Attribute | Description
----------|-------------
`token` | Unique user token


## Get User
This end-point will provide all user's attributes.

### Request
`GET <%= config[:base_url] %>/user`

```http
GET /user HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer [USER_TOKEN]
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  ch = curl_init();
  $user_token = '[USER_TOKEN]';
  $api_key = '[API_KEY]';

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'Authorization: Bearer ' . $user_token,
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user" \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -H "api-key: [API_KEY]"
```

### Response
> The above request returns JSON structured like this:

```json
{
    "id": 999,
    "email": "dummy_person@gmail.com",
    "email_verified": true,
    "name": "Im Dummy Person",
    "identity_number": "317500010001",
    "identity_type": "ktp",
    "birth_date": "2000-01-01",
    "birth_place": 3492,
    "address": "Jln. Dummy Place",
    "city": 3405,
    "phone_number": "+6285729685018",
    "phone_number_verified": true,
    "identity_image": "59_eaa4eba9453d906d8f5ae1816ecaf2fc_1522653089.jpg",
    "face_image": "59_725ba12bb7e49d650042fe46c2a5b5b5_1522653089.jpg",
    "face_and_identity_image": "59_c23bca50e0fc1ea05a074928489dcdfb_1521443408.jpeg",
    "deposit": 9999,
    "saving": 9999,
    "created_source": '[App ID]',
    "kyc_status": 2
}
```

Attribute | Description
----------|-------------
`id` | User's id
`email` | User's email
`email_verified` | Email verification status. Possible values are:<br><ul><li>`true`<br>User has done email verification</li><li>`false`<br>User hasn't done email verification. User should click confirmation link sent to email</li></ul>
`name` | User's full name
`identity_type` | User's identity type. Pick one from the option. Options:<ul><li>`ktp`<br>Identity card (acronym of Kartu Tanda Penduduk)</li><li>`sim`<br>Driving license (acronym of Surat Izin Mengemudi)</li><li>`paspor`<br>Passport</li></ul>
`identity_number` | User's identity number depends on `identity_type`
`birth_date` | User's birth date.<br>`Format: YYYY-MM-DD`
`birth_place` | User's birth place.<br>Base on city code list
`address` | Current user's address.
`city` | Current user's city of residence<br>Base on city code list
`phone_number` | User's phone number. Start with country code.
`phone_number_verified` | Phone number verification status. Possible values are:<br><ul><li>`true`<br>User has done phone number verification</li><li>`false`<br>User hasn't done phone number verification</li></ul>
`kyc_status` | *Know Your Customer* status. Possible values are:<br><ul><li>`0`<br>User hasn't filled identity information and hasn't been verified kyc image by Flip</li><li>`1`<br>User has filled identity information but hasn't been verified kyc verification by Flip</li><li>`2`<br>User has filled identity information and has been verified kyc verification by Flip. **Only user with kyc_status = 2 that can create a transaction in Flip**.</li><li>`3`<br>User kyc was rejected by Flip</li><li>`4`<br>User kyc was banned by Flip<\li></ul>
`identity_image` | Url of the identity card image
`face_image` | Url of the close up face image
`face_and_identity_image` | Url of the combination image. Contain user's face hold identity card.
`deposit` | User's deposit amount
`saving` | User's saving amount
`created_source` | The channel of which the user account was created. Contain application ID

## Update User
This end-point will insert/update user's attributes.

### Request
`POST <%= config[:base_url] %>/user`

```http
POST /user HTTP/1.1
Content-Type: multipart/form-data
Authorization: Bearer [USER_TOKEN]
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $user_token = '[USER_TOKEN]';
  $api_key = '[API_KEY]';
  $payloads = [
      'email' => 'dummy@email.com',
      'name' => 'Im Dummy',
      'identity_number' => '3175000100010001',
      'identity_type' => 'ktp',
      'birth_date' => '1994-04-20'
      'birth_place' => '1039',
      'phone_number' => '081318171612',
      'city' => '1039',
      'address' => 'Jln. Dummy'
  ];

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: multipart/form-data',
                         'Authorization: Bearer' . $user_token,
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $payloads);

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user" \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -H "api-key: [API_KEY]" \
  -F "email"="dummy@email.com" \
  -F "name"="Im Dummy" \
  -F "identity_number"="3175000100010001" \
  -F "identity_type"="ktp" \
  -F "birth_date"="1994-04-20" \
  -F "birth_place"="1039" \
  -F "phone_number"="081318171612" \
  -F "city"="1039" \
  -F "address"="Jln. Dummy" \
```

**Parameters**

Parameter | Type | Description
--------- | ----------- | -----------
`email` | *string* | **`optional`**<br>User's email
`name` | *string* | **`optional`**<br>User's full name
`identity_type` | *string* | **`optional`**<br>User's identity type. Pick one from the option. Options:<ul><li>`ktp`<br>Identity card (acronym of Kartu Tanda Penduduk)</li><li>`sim`<br>Driving license (acronym of Surat Izin Mengemudi)</li><li>`paspor`<br>Passport</li></ul>
`identity_number` | *string* | **`optional`**<br>User's identity number depends on `identity_type`
`birth_date` | *string* | **`optional`**<br>User's birth date.<br>`Format: YYYY-MM-DD`
`birth_place` | *string* | **`optional`**<br>User's birth place.<br>Base on city code list
`address` | *string* | **`optional`**<br>Current user's address.
`city` | *string* | **`optional`**<br>Current user's city of residence<br>Base on city code list
`phone_number` | *string* | **`optional`**<br>User's phone number. Start with country code.

### Response
```json
{
  "message": "Your account has been updated sucessfully"
}
```

The above request returns JSON structured like this:

Attribute | Description
----------|-------------
`message` | Successful message

## Upload User Identity Image
This end-point will update user identity images.

### Request
`POST <%= config[:base_url] %>/user/upload-identity-image`

```http
POST /user HTTP/1.1
Content-Type: multipart/form-data
Authorization: Bearer [USER_TOKEN]
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $user_token = '[USER_TOKEN]';
  $api_key = '[API_KEY]';
  $payloads = [
      'identity_image' => '@/home/user1/Desktop/identity_image.jpg',
      'face_image' => '@/home/user1/Desktop/face_image.jpg',
      'face_and_identity_image' => '@/home/user1/Desktop/face_and_identity_image.jpg',
  ];

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/upload-identity-image");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: multipart/form-data',
                         'Authorization: Bearer' . $user_token,
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $payloads);

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/upload-identity-image" \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -H "api-key: [API_KEY]" \
  -F "identity_image"="@/home/user1/Desktop/identity_image.jpg" \
  -F "face_image"="@/home/user1/Desktop/face_image.jpg" \
  -F "face_and_identity_image"="@/home/user1/Desktop/face_and_identity_image.jpg"
```

**Parameters**

Parameter | Type | Description
--------- | ----------- | -----------
`identity_image` | *file* | **`optional`**<br>User's identity card image depends on `identity_type`
`face_image` | *file* | **`optional`**<br>User's face image (close up)
`face_and_identity_image` | *file* | **`optional`**<br>Combination image. Contain user's face hold identity card.

### Response
```json
{
  "message": "Identity images has been updated sucessfully"
}
```

The above request returns JSON structured like this:

Attribute | Description
----------|-------------
`message` | Successful message

## Verify Phone Number
This end point will ask Flip to verify user's phone number.

### Request
`POST <%= config[:base_url] %>/user/verify-phone-number`

```http
POST /user/verify-phone-number HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer [USER_TOKEN]
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $user_token = '[USER_TOKEN]';
  $api_key = '[API_KEY]';
  $payloads = [
      'token' => '[PHONE_VERIFICATION_CODE]',
  ];

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/verify-phone-number");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'Authorization: Bearer' . $user_token,
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);
  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($payloads));

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/verify-phone-number" \
  -X POST \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -H "api-key: [API_KEY]" \
  -d token="[PHONE_NUMBER_VERIFICATION_CODE]"
```

**Parameters**

Parameter | Type | Description
--------- | ----------- | -----------
`token` | *string* | **`required`**<br>Verification code that Flip sent to phone using SMS.

### Response
```json
{
  "message": "Your phone number has been verified sucessfully"
}
```

The above request returns JSON structured like this:

Attribute | Description
----------|-------------
`message` | Successful message

## Verify Identity
This end point will ask Flip to verify user's identity.

### Request
`POST <%= config[:base_url] %>/user/verify-identity`

```http
POST /user/verify-phone-number HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer [USER_TOKEN]
api-key: [API_KEY]
```

>Example Command:

```php
<?php
  $ch = curl_init();
  $user_token = '[USER_TOKEN]';
  $api_key = '[API_KEY]';

  curl_setopt($ch, CURLOPT_URL, "<%= config[:base_url] %>/user/verify-identity");
  curl_setopt($ch, CURLOPT_HTTPHEADER,
                   array('Content-Type: application/x-www-form-urlencoded',
                         'Authorization: Bearer' . $user_token,
                         'api-key:' . $api_key));
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_HEADER, FALSE);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt($ch, CURLOPT_POST, TRUE);

  $response = curl_exec($ch);
  $response = json_decode($response, true);

  curl_close($ch);
```

```shell
curl "<%= config[:base_url] %>/user/verify-identity" \
  -X POST \
  -H "Authorization: Bearer [USER_TOKEN]" \
  -H "api-key: [API_KEY]" \
```

### Response
```json
{
  "message": "Your phone number has been verified sucessfully"
}
```

The above request returns JSON structured like this:

Attribute | Description
----------|-------------
`message` | Successful message